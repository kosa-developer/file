<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:p="http://primefaces.org/ui" template="/WEB-INF/template.xhtml">

    <ui:define name="content">

        <div class="card p-grid">            
            <h:form id="form_subtest" class="card p-col-12 p-md-4">
                <h5>Register Expected Results</h5>
                <div class="ui-fluid p-formgrid p-grid p-col-12 p-md-12" >
                <div class="p-field ">
                    <h:outputLabel value="Test category"/>
                    <p:selectOneMenu filter="true"  id="testcat" value="#{adminBean.test_category_id}" required="true">  
                        <f:selectItem itemLabel="Select Category" itemValue="Select" />  
                        <f:selectItems value="#{adminBean.admin_get_test_categories()}" var="category" itemLabel="#{category.category_desc}" itemValue="#{category.category_id}" />  
                        <p:ajax update="testname"/>
                    </p:selectOneMenu>
                </div>
                <div class="p-field ">
                    <h:outputLabel value="Test Name:" />
                        <p:selectOneMenu filter="true"    id="testname" value="#{adminBean.test_name_id}" required="true">  
                            <f:selectItem itemLabel="Select Test Name" itemValue="Select" />  
                            <f:selectItems value="#{dynamicFunctionsBean.ReturnSpecialdropdownList('test_names', 'test_id', 'test_name','category_id', adminBean.test_category_id)}" var="test" itemLabel="#{test.dropdownValue}" itemValue="#{test.dropdownId}" />  
                         <p:ajax update="specifictest"/>
                        </p:selectOneMenu>
                </div>
                <div class="p-field">
                     <h:outputLabel value="Specific Test:" />
                    <p:selectOneMenu  id="specifictest" value="#{adminBean.specific_test_id}"  required="true">  
                        <f:selectItem itemLabel="Select Specific Test" itemValue="Select" />  
                        <f:selectItems value="#{dynamicFunctionsBean.ReturnSpecialdropdownList('specific_tests', 'specific_test_id', 'specific_test','test_id', adminBean.test_name_id)}" var="spec" itemLabel="#{spec.dropdownValue}" itemValue="#{spec.dropdownId}" />  
                   <p:ajax update="subtest"/>
                         </p:selectOneMenu>
                </div>
                    
                    <div class="p-field">
                    <h:outputLabel value="Sub Test:" />
                    <p:selectOneMenu  id="subtest" value="#{adminBean.sub_test_id}"  required="true">  
                        <f:selectItem itemLabel="Select subtest" itemValue="Select" />  
                        <f:selectItems value="#{dynamicFunctionsBean.ReturnSpecialdropdownList('sub_tests', 'sub_test_id', 'sub_test','specific_test_id', adminBean.specific_test_id)}" var="spec" itemLabel="#{spec.dropdownValue}" itemValue="#{spec.dropdownId}" />  
                    </p:selectOneMenu>
                    </div>
                     <div class="p-field">
                     <h:outputLabel value="Expected Result:" />
                     <p:inputText id="expectedrst"  value="#{adminBean.expected_result}" required="true"/>
                     </div>

                 </div>
                <p:commandButton id="saveBtn" value="Save" action="#{adminBean.admin_add_expected_result()}" update=":tableform:resultTb,form_subtest" icon="pi pi-check"   styleClass="p-mt-3" />
                <p:messages/>
            </h:form>
            <h:form id="tableform" class="card p-col-12 p-md-8">

                <p:dataTable rows="5" widgetVar="specifictestTable" id="resultTb" value="#{adminBean.admin_get_expected_results()}" 
                             paginator="true" scrollable="true" editable="true" 
                             paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                             currentPageReportTemplate="{startRecord}-{endRecord} of {totalRecords} records"
                             rowsPerPageTemplate="5,10,100,200,500,1000,{ShowAll|'All'}"
                             showGridlines="true" size="small" var="pres" style="width: 100%;"
                             emptyMessage="No Specific Test Has Been Added ">
                    <f:facet name="header">
                        <div class="p-d-flex p-ai-center p-jc-between">
                            <h5>List of Expected results</h5>
                        </div>
                    </f:facet>
                    <p:ajax event="rowEdit" listener="#{dynamicFunctionsBean.admin_edit_table_data('expected_results', 'result', 'result_id', pres.expected_result_id, result.value)}" update="resultTb"  />
                    <p:ajax event="rowEditCancel" listener="#{dynamicFunctionsBean.onRowCancel}" update="resultTb" />

                    <p:column headerText="Test Category"   filterBy="#{pres.test_category}"  sortBy="#{pres.test_category}">  
                        #{pres.test_category}  
                    </p:column>

                    <p:column headerText="Test Name" filterBy="#{pres.test_name}" sortBy="#{pres.test_name}"  >  
                        #{pres.test_name}  
                    </p:column>
                    <p:column headerText="Specific Test" filterBy="#{pres.specific_test}" sortBy="#{pres.specific_test}" >  
                        #{pres.specific_test}  
                    </p:column>
                     <p:column headerText="Sub Test" filterBy="#{pres.sub_test}" sortBy="#{pres.sub_test}"  >  
                        #{pres.specific_test}  
                    </p:column>
                    <p:column headerText="Expected Result" filterBy="#{pres.expected_result}" sortBy="#{pres.expected_result}" > 
                             <p:cellEditor>
                                 <f:facet name="output"><h:outputText value="#{pres.expected_result}" /></f:facet>
                                 <f:facet name="input"><p:inputText placeholder="#{pres.expected_result}" binding="#{result}" class="form-control" label="result"/></f:facet>
                            </p:cellEditor>
                        </p:column> 

                        <p:column styleClass="tblcol2" >  
                            <p:rowEditor id="edit_result" />
                            <p:tooltip for="edit_result" value="edit result" position="right"/>
                        </p:column> 

                </p:dataTable>
            </h:form>
        </div>

    </ui:define>
</ui:composition>
